# ZipBomb Evaluator - Complete File Manifest & Checklist

## ðŸ“¦ Repository Contents

### Core Application Files (3 files)

| File | Purpose | Location |
|------|---------|----------|
| **ZipBombEvaluator.java** | Core zip bomb detection engine with recursive nested inspection | `src/main/java/.../util/` |
| **ZipBombEvaluatorMain.java** | Executable entry point with CLI and formatted output | `src/main/java/.../` |
| **DocumentIndexerSecurityFilter.java** | WSO2 integration helper | `src/main/java/.../indexer/` |

### Test Files (1 file)

| File | Purpose | Location |
|------|---------|----------|
| **ZipBombEvaluatorTest.java** | JUnit test suite & usage examples | `src/test/java/.../util/` |

### Configuration Files (3 files)

| File | Purpose |
|------|---------| 
| **pom.xml** | Maven build configuration |
| **commons-logging.properties** | Logging config (JUL backend) |
| **dependency-reduced-pom.xml** | Generated by shade plugin (auto-created on build) |

### Build & Setup Scripts (2 files)

| File | Purpose |
|------|---------| 
| **setup.sh** | Automated setup (Linux/macOS) |
| **setup.bat** | Automated setup (Windows) |

### Test Data (3 files)

| File | Purpose |
|------|---------| 
| **testfiles/test-zipbomb.xlsx** | Direct zip bomb (335:1 compression ratio) |
| **testfiles/testzipbomb.zip** | Nested zip bomb (contains test-zipbomb.xlsx) |
| **testfiles/admin-PizzaShackAPI-1.0.0.zip** | Clean archive (should pass) |

### Documentation Files (4 files)

| File | Purpose |
|------|---------| 
| **README.md** | Complete project documentation |
| **QUICK_START.md** | 5-minute setup guide |
| **SETUP_GUIDE.md** | Detailed directory structure & setup |
| **FILE_MANIFEST.md** | This file |

### Other Files (2 files)

| File | Purpose |
|------|---------| 
| **LICENSE** | Apache License 2.0 |
| **.gitignore** | Git ignore rules |

---

## ðŸš€ Quick Start Checklist

### Before You Start
- [ ] Java 17 or later installed (`java -version`)
- [ ] Maven 3.8.1 or later installed (`mvn -version`)
- [ ] At least 2GB free disk space
- [ ] Internet connection (for Maven dependency downloads)

### Step 1: Clone the Repository
```bash
git clone https://github.com/<your-user>/AI-Apache-POI-ZipBomb-Checker.git
cd AI-Apache-POI-ZipBomb-Checker
```

### Step 2: Build (3-5 min)
**On Linux/macOS:**
```bash
chmod +x setup.sh
bash setup.sh
```

**On Windows:**
```bash
setup.bat
```

### Step 3: Verify Installation (1 min)
```bash
java -jar target/zipbomb-evaluator-1.0.0-standalone.jar --help
```
You should see the help message with usage instructions.

### Step 4: Test It Works (1 min)
```bash
java -jar target/zipbomb-evaluator-1.0.0-standalone.jar ./testfiles/*
```
Expected: `admin-PizzaShackAPI-1.0.0.zip` passes, both `test-zipbomb.xlsx` and `testzipbomb.zip` fail.

---

## ðŸ“‹ What Each File Does

### ðŸ”§ Core Application

**ZipBombEvaluator.java**
- Main security utility class
- Detects zip bombs in multiple formats
- **Recursive inspection** of nested archives (zip inside zip, xlsx inside zip, etc.)
- Configurable security thresholds
- Bounded extraction with safety caps (100MB per entry, 10 nesting levels)
- Temp file cleanup in `finally` blocks
- Detailed diagnostic output with nesting path reporting

**ZipBombEvaluatorMain.java**
- Entry point for command-line execution
- Formatted output with statistics
- Supports multiple file arguments
- Exit codes for scripting (0 = pass, 1 = threats found)
- Help and version display

**DocumentIndexerSecurityFilter.java**
- Bridges ZipBombEvaluator with WSO2 API Manager
- Handles temporary files and cleanup
- Throws SecurityException on violations

### ðŸ§ª Testing

**ZipBombEvaluatorTest.java**
- JUnit 4 test suite with proper @Test annotations and assertions
- Tests for non-existent files, plain text files, result formatting
- Getter validation tests

**testfiles/**
- `test-zipbomb.xlsx` â€” Direct zip bomb with 335:1 compression ratio on `xl/styles.xml`
- `testzipbomb.zip` â€” Contains `test-zipbomb.xlsx` inside it (tests recursive detection)
- `admin-PizzaShackAPI-1.0.0.zip` â€” Clean WSO2 API export (should always pass)

### ðŸ”¨ Build Configuration

**pom.xml**
- Complete Maven configuration
- All required dependencies:
  - Apache POI 5.2.5 (Excel, Word, PowerPoint)
  - PDFBox 3.0.1 (PDF processing)
  - Apache Commons IO 2.15.1, Lang3 3.14.0 (utilities)
  - Commons Logging 1.2 (logging facade)
  - JUnit 4.13.2 (testing)
- Log4j-api excluded from POI to prevent classpath conflicts
- Includes maven-shade for standalone fat JAR
- Configured for Java 17

**commons-logging.properties**
- Forces commons-logging to use `Jdk14Logger` (java.util.logging)
- Prevents any accidental Log4j discovery at runtime

**setup.sh / setup.bat**
- Check Java and Maven versions
- Create directory structure if needed
- Verify file placement
- Run `mvn clean package`
- Display build results

---

## ðŸŽ¯ What Gets Built

After running setup, your `target/` directory will contain:

```
target/
â”œâ”€â”€ zipbomb-evaluator-1.0.0.jar              (~20 KB)
â”œâ”€â”€ zipbomb-evaluator-1.0.0-standalone.jar   (~27 MB) â† USE THIS
â”œâ”€â”€ classes/                                 (compiled code)
â”œâ”€â”€ test-classes/                            (test code)
â””â”€â”€ ...other Maven files...
```

**The standalone JAR** includes all dependencies and can run anywhere with Java 17+.

---

## ðŸ“Š Repository Layout

```
AI-Apache-POI-ZipBomb-Checker/
â”œâ”€â”€ pom.xml                                  â† Maven config
â”œâ”€â”€ setup.sh & setup.bat                     â† Auto-setup scripts
â”œâ”€â”€ LICENSE                                  â† Apache 2.0
â”œâ”€â”€ .gitignore
â”‚
â”œâ”€â”€ testfiles/                               â† Sample test data
â”‚   â”œâ”€â”€ test-zipbomb.xlsx                    â† Direct bomb
â”‚   â”œâ”€â”€ testzipbomb.zip                      â† Nested bomb
â”‚   â””â”€â”€ admin-PizzaShackAPI-1.0.0.zip       â† Clean file
â”‚
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main/java/org/wso2/carbon/apimgt/impl/indexing/
â”‚   â”‚   â”œâ”€â”€ util/
â”‚   â”‚   â”‚   â””â”€â”€ ZipBombEvaluator.java        â† Core engine (recursive)
â”‚   â”‚   â”œâ”€â”€ ZipBombEvaluatorMain.java        â† CLI entry point
â”‚   â”‚   â””â”€â”€ indexer/
â”‚   â”‚       â””â”€â”€ DocumentIndexerSecurityFilter.java
â”‚   â”‚
â”‚   â”œâ”€â”€ main/resources/
â”‚   â”‚   â””â”€â”€ commons-logging.properties       â† JUL logging config
â”‚   â”‚
â”‚   â””â”€â”€ test/java/org/wso2/carbon/apimgt/impl/indexing/util/
â”‚       â””â”€â”€ ZipBombEvaluatorTest.java
â”‚
â”œâ”€â”€ target/                                  â† Built artifacts (after build)
â”‚   â”œâ”€â”€ zipbomb-evaluator-1.0.0-standalone.jar  â† Ready to use!
â”‚   â””â”€â”€ ...
â”‚
â””â”€â”€ Documentation/
    â”œâ”€â”€ QUICK_START.md                       â† 5 min to running
    â”œâ”€â”€ SETUP_GUIDE.md                       â† Detailed setup
    â”œâ”€â”€ README.md                            â† Full documentation
    â””â”€â”€ FILE_MANIFEST.md                     â† This file
```

---

## ðŸ’» Command Quick Reference

### Building
```bash
mvn clean compile              # Compile only
mvn clean package              # Build JAR files
mvn clean install              # Build & install to local repo
```

### Running
```bash
# Test files included in repo
java -jar target/zipbomb-evaluator-1.0.0-standalone.jar ./testfiles/*

# Single file
java -jar target/zipbomb-evaluator-1.0.0-standalone.jar document.xlsx

# Multiple files
java -jar target/zipbomb-evaluator-1.0.0-standalone.jar *.xlsx *.docx

# Help / version
java -jar target/zipbomb-evaluator-1.0.0-standalone.jar --help
java -jar target/zipbomb-evaluator-1.0.0-standalone.jar --version
```

### Testing
```bash
mvn test                       # Run all tests
mvn test -Dtest=ZipBombEvaluatorTest  # Specific test
```

### Troubleshooting
```bash
mvn clean                      # Clean build artifacts
mvn dependency:tree            # Show dependencies
rm -rf ~/.m2/repository        # Clear Maven cache
mvn clean compile -X           # Verbose output
```

---

## âœ… Verification Checklist

After setup completes, verify everything works:

```bash
# 1. Check Java version (17+)
java -version

# 2. Check Maven (3.8.1+)
mvn -v

# 3. Verify JAR exists
ls -lh target/*standalone*.jar

# 4. Test CLI
java -jar target/zipbomb-evaluator-1.0.0-standalone.jar --help

# 5. Test with included test files
java -jar target/zipbomb-evaluator-1.0.0-standalone.jar ./testfiles/*
# Expected: 1 pass, 2 threats detected
```

---

## ðŸ†˜ Common Issues

### Issue: "Cannot find pom.xml"
**Solution**: Make sure pom.xml is in the root directory where you're running Maven from.

### Issue: "Java version too old"
**Solution**: Install Java 17+. Update JAVA_HOME if needed.

### Issue: "Maven not found"
**Solution**: Install Maven 3.8.1+ and add to PATH.

### Issue: Build fails with "dependency not found"
**Solution**: 
```bash
rm -rf ~/.m2/repository
mvn clean compile
```

### Issue: `grep: invalid option -- P` on macOS
**Solution**: Use the latest `setup.sh` â€” the `grep -P` (GNU-only) has been replaced with `grep -oE` which works on both macOS and Linux.

---

## ðŸ“š Which File Should I Read?

| Your Situation | Read This |
|---|---|
| I want to get running NOW | **QUICK_START.md** |
| I have setup errors | **SETUP_GUIDE.md** |
| I need full documentation | **README.md** |
| I want to see code examples | **ZipBombEvaluatorTest.java** |
| I need the implementation details | **ZipBombEvaluator.java** |

---

## ðŸ”’ What It Detects

âœ“ Excessive compression ratios (zip bombs)
âœ“ **Nested zip bombs** (malicious files hidden inside clean archives)
âœ“ Oversized individual entries
âœ“ Total archive size violations
âœ“ Malformed zip structures
âœ“ Corrupted Office documents
âœ“ Recursive archive nesting (depth > 10)
âœ“ Format mismatches

---

## ðŸ“ˆ Performance

- **Evaluation time**: 5-50ms per file
- **JAR size**: ~27 MB (standalone with dependencies)
- **Build time**: 30-60 seconds
- **Supported formats**: XLSX, DOCX, PPTX, XLS, DOC, PPT, PDF, ZIP, JAR, WAR
- **Security threshold**: 100:1 compression ratio (configurable)
- **Max recursion depth**: 10 nesting levels

---

**You now have a complete, production-ready zip bomb detection system!** ðŸŽ‰

Start with QUICK_START.md and you'll be up and running in 5 minutes.
